<!doctype html>
<html class="no-js" lang="en">
    <head>
        <meta charset="utf-8">
        <meta http-equiv="x-ua-compatible" content="ie=edge">
        <title>aTz || Largest online B2B marketplace </title>
        <meta name="description" content="">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <link rel="icon" href="<?php echo base_url(); ?>assets/admin/images/favicon.ico" type="image/x-icon">
        <title> aTz || Largest online B2B marketplace </title>
        <!--<link rel="icon" type="image/x-icon" href="assets/front/images/icons/icon_logo.png"> -->    
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/bootstrap.min.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/font-awesome.min.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/ionicons.min.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/css-plugins-call.css">       
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/main.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/responsive.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/colors.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/demo.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/jquery.mmenu.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/swiper.min.css"> 
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/all-comman.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/bundle.css">
        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/product_details.css">
        <link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/front/css/reset.css">
       <!--  <link rel="stylesheet" type="text/css" href="<?php echo base_url(); ?>assets/front/css/jquery-picZoomer.css"> -->
        <link href="<?php echo base_url(); ?>assets/front/css/jquery-ui.css" rel="Stylesheet">
        <link href="<?php echo base_url(); ?>assets/front/css/customheader.css" rel="Stylesheet">

        <link rel="stylesheet" href="<?php echo base_url(); ?>assets/front/css/all-inside-inline.css">
    <style>

    .price{
        font-weight: 500 !important;
        font-size: 13px !important;
        color: #000000ad !important;
    }
    .biz-action-bar-button{
        background-color: #bd081b !important;
    }
    body {
        background-color: #F7F8FA
    }
    .draft {
        padding: 20px;
        max-width: 1200px;
        min-width: 700px;
        background-color: #F7F8FA;
        margin: auto
    }
    .draft .next-icon-help:before,
    .draft .next-icon-success:before {
        color: #1DC11D
    }
    .draft .next-form-item {
        margin-bottom: 12px
    }
    .draft .draft-taBlock {
        border: 1px solid #FFB380
    }
    .draft .draft-productsAmountBlock {
        display: -ms-flexbox;
        display: flex;
        -ms-flex-align: end;
        align-items: flex-end;
        -ms-flex-direction: column;
        flex-direction: column
    }
    .next-form-item-control {
        line-height: 28px
    }
    .next-form-item-control .next-btn-text.next-btn-medium {
        margin: 0
    }
    .remarkContent_1 .next-form-item-control,
    .remarkInput_1 .next-form-item-control {
        width: 100%
    }
    .remarkContent_1 .next-form-item-control .next-input,
    .remarkInput_1 .next-form-item-control .next-input {
        width: 100%
    }
    .biz-block-card-wrap {
        margin: 0 0 20px;
        padding-bottom: 20px
    }
    .bg-color{
        background-color: unset !important;
    }
    .product .pic{
        width: 30% !important;
    }
    .wd100{
        width: 100% !important;
    }
    .font-13{
        font-size: 13px !important;
    }
    #loading {
        width: 100%;
        height: 100%;
        top: 0;
        left: 0;
        position: fixed;
        display: block;              
        background-color: rgba(0,0,0,0.4);
        z-index: 99;
        text-align: center;
    }

    #loading-image {
        position: absolute;
        top: 170px;
        left: 38%;
        z-index: 99999;
    }
.modal-dialog {
      width: 360px;
    }
.modal-header {
    background-color: #337AB7;
    padding:16px 16px;
    color:#FFF;
    border-bottom:2px dashed #337AB7;
 }

/*label {
  float: left;
  clear: none;
  display: block;
  padding: 2px 1em 0 0;
}*/

input[type=radio],
input.radio {
  float: left;
  clear: none;
  margin: 2px 0 0 2px;
}

.display_none
{
    display:none!important;
}
.card{background:none;}
/*
*/
.mmnew{ box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .16), 0 2px 10px 0 rgba(0, 0, 0, .12); height:220px;}

.maincard {
   /* box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .16), 0 2px 10px 0 rgba(0, 0, 0, .12);*/
    border: 0;
    font-weight: 400;
    }
    .payment_option .card_main
    {
    background:none;
    color:#000;       
    }

    .payment_option .card-header
    {
    padding:.4rem 1rem;
    }

    .payment_option .card-header h5 
    {
    background:none;
    }

    .payment_option .card_main p
    {
    color:#000; 
    text-transform:uppercase;
    font-weight:600;      
    }
    .payment_option .card-body
    {
    padding:0px !important;
    }
    .credit input{
    border-radius:0px;
    height:40px;
    }

    .btn {
    box-shadow: 0 2px 5px 0 rgba(0,0,0,.16), 0 2px 10px 0 rgba(0,0,0,.12);
    padding: .4rem 2.14rem;
    color:#fff;
    font-size:1.3rem;
    transition: color .15s ease-in-out,background-color .15s ease-in-out,border-color .15s ease-in-out,box-shadow .15s ease-in-out;
    border: 0;
    border-radius: .125rem;
    cursor: pointer;
    text-transform: uppercase;
    white-space: normal;
    word-wrap: break-word;
    color: #fff;
   }
.waves-effect {
    position: relative;
    cursor: pointer;
    overflow: hidden;
    -webkit-user-select: none;
    -moz-user-select: none;
    -ms-user-select: none;
    user-select: none;
    -webkit-tap-highlight-color: transparent;
}
    .maincard1
    {
    border: 0 !important;
    }
    .maincard1 .card-header {
    border-top: 1px solid rgba(0,0,0,.1) !important;
    border-radius: 0 !important;
    background:#fff !important;
    border-bottom:0px !important;
    }
    .align-items{
        text-align:center!important;
    }
    #success-message {
        background-color:#d4edda;color:#155724;border-color:#c3e6cb;
    }
    #error-message {
        background-color:#f8d7da;color:#721c24;border-color:#f5c6cb;
    }
    .tablew
    {
       /* margin-left: -17px;*/
       border: 1px solid lightgray;
    }
	
	.cd1{box-shadow: 0 2px 5px 0 rgba(0, 0, 0, .16), 0 2px 10px 0 rgba(0, 0, 0, .12); margin-bottom:10px; border-left: 3px solid #dc3545 !important;}
    </style>
    </head>
    <body>
        <div class="d-block d-sm-none">
            <div class="header-wrap demonavheader">
                <div class="site-header with-shadow">
                    <div class="main-header">
                        <a class="header-item btn-search " onclick="openNav()"><i class="fa fa-bars"></i></a>
                        <a class="header-item logo" href="/"><img src="<?php echo base_url(); ?>assets/front/images/logo/logo.png" alt=""></a>
                    </div>
                    <div class="search-text">
                        <div class="search-bar">
                            <div class="searchbar">
                                <input class="search_input" type="text" name="" placeholder="Search...">
                                <a href="#" class="search_icon"><i class="fa fa-search"></i></a>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        </div>

        <div class="main" style="background-color: #F7F8FA;">            
            <div id="draft" class="draft">
                  <div class="mb-3">
                    <a href="<?php echo base_url(); ?>">
					<div id="brandIntro_1" class="brand-intro" style="height: 20px;">
                            <h2><img style="width:200px;" src="<?php echo base_url(); ?>assets/front/images/logo/logo.png">&nbsp;&nbsp;&nbsp; Start Order</h2></a>
                    </div>
              </div>
            <br>
            <div>
                <div class="next-step next-step-arrow next-step-horizontal base-step draft-stepBlock stepBlock_1">
                    <div data-spm-click="gostr=/sc.1;locaid=d_step;step=Start Order" class="next-step-item  next-step-item-first next-step-item-wait"
                         style="width: auto;">
                        <div class="next-step-item-container ">
                            <div class="next-step-item-title ">Start Order</div>
                        </div>
                    </div>



                    <div class="next-step-item next-step-item-wait next-step-item-process" style="width: auto;">
                        <div class="next-step-item-container">
                            <div class="next-step-item-title">
                                Ship & Payment</div>
                        </div>
                    </div>


                    <div data-spm-click="gostr=/sc.1;locaid=d_step;step= Confirm Receipt" class="next-step-item next-step-item-wait next-step-item-last"
                         style="width: auto;">
                        <div class="next-step-item-container">
                            <div class="next-step-item-title">
                                Confirm Receipt</div>
                        </div>
                    </div>
                </div>
            </div>
            <br>

               <?php echo $this->session->flashdata('message'); ?>
        </div>
   
        <?php
                if (isset($pending_order)) {
                    if ($pending_order == 'Accepted') {

                        ?>     
                         <div id="loading" style="display:none;">
                                <img id="loading-image" src="<?php echo base_url(); ?>assets/front/images/loader1.gif" alt="Loading..." style="width:250px;height:300px;" />
                         </div>

                      
                    <?php } elseif ($pending_order == 'Rejected') {

                        ?>
                        <div class="ui2-feedback ui2-feedback-large ui2-feedback-success notice" data-spm="notice" data-spm-anchor-id="a2700.8267363.0.notice.7b673e5fRsiKW0">

                            <div class="ui2-feedback-title"> <img src="<?php echo base_url(); ?>assets/delete.png" style="width:25px;">&nbsp;&nbsp; Order Rejected By Seller</div><br>
                            <div class="ui2-feedback-content">

                                <div class="feedback-action">
                                    <a href="#" class="ui2-button ui2-button-default ui2-button-normal ui2-button-medium">Go to Message Center</a>
                                    <a href="<?php echo base_url(); ?>" class="ui2-button ui2-button-normal ui2-button-medium app-button" target="_blank">
                                        <i class="phone-icon iphone"></i>
                                        <i class="phone-icon andriod"></i>
                                        <span class="text"><img src="<?php echo base_url(); ?>assets/playstore.png" style="width:20px;">&nbsp;&nbsp;Download the ATZ Cart App</span>
                                    </a>

                                </div>
                            </div>
                        </div>
                        <?php
                    }
                }
                ?>
                <?php 
 
$final_price1=0;
$shipping_cost=0;
$order_price=0;
$order_from='';
$wallet_balance=0; 
$totalBalance=0;
$wallet_option='';
    foreach ($product_details as $key ) {
        # code...
         $final_price1 += $key->final_price;
           $totalBalance += $key->final_price;
         // echo "<br/>";
           $shipping_cost = $key->shipping_cost;

            $order_price = $key->order_price;  

           $order_from= $key->order_from; 

           $wallet_option= $key->wallet_option;         
    }
  
        if(trim($order_from)==='Cart')   
         {
                $wallet_balance= $bal->balance;
            
            if($wallet_option==='unchecked')    
            {
                $totalBalance= $final_price1;
            }
            else if($wallet_option==='checked' && $final_price1 >= $wallet_balance)
            {
                    $totalBalance= $final_price1-$wallet_balance;
            }

         }   
         
         
   ?>

        <form action="<?php echo base_url('payment/payment_process')?>" method="post" name="customerData" class="credit" id="paymentForm">
    <!--div for wallet option-->
                <div class="ui2-box so-extraBlock container walletDiv " style="">
                            <div class="ui2-box-wrap mx-2 p-2 mb-0 shadow h-50" data-spm-anchor-id="a2700.8592591.0.i1.7bdf10a9eV3SXz">
                                <!-- react-text: 95 --><!-- /react-text -->
                                 
                                    <div class="next-form-item next-row shipping-item mb-0"  label="Shipping method">
                                        <!--<label class="next-col-3 next-form-item-label">Shipping method : </label>-->
                                        <div class="container p-0 next-form-item-control">
                                            <input type="hidden" name="shipping_method" value="Land Transportation">
                                            <!--<b>Land Transportation</b>
                                             react-text: 152 --> <!-- /react-text -->
                                        <div class="row " style="">
                                            <div class="col-xs-12 col-md-8  p-0">
                                                <div class="input-group">
                                                 <input type="checkbox" class="checkboxClass" name="chk_wallet_val" style="margin-top:-4px" value="unchecked">
                                                 <input class="checkboxClass" type="hidden" id="chk_wallet_val" name="chk_wallet_val" value="unchecked">
                                                  <label>&nbsp; Available ATZ Wallet Balance</label>
                                                </div>
                                            </div>

                                             <div class="col-xs-12 col-sm-4 pr-0" style="float:right!important;">
                                             <!-- <p id="wallet_balance"  class="text-right"></p>   -->
                                               <div id="productsAmountBlock_1" class="block draft-productsAmountBlock">
                                                <div class="biz-products-amount" style="float:right!important">
                                                   <span> <p id="wallet_balance" class="text-right" style="font-size: 18px"></p></span>
                                                </div>
                                                </div>
                                              <input type="hidden" name="wallet_amount" id="wallet_amount" value="<?php echo $bal->balance; ?>">

                                               <input type="hidden" name="total_amount" id="total_amount" value="<?php echo $order_price; ?>">

                                            </div>
                                            <p id="p_error" style="text-align:center;color:red;"></p>
                                        </div>

                                            <!-- react-text: 154 --> <!-- /react-text -->
                                        </div>
                                    </div>
                                 
                            </div>
                        </div>

    <!--div for payment methods-->
     
<div id="final_payment_section" style="">
 
<main class="pt-4">
    <div class="container">
        <!--Grid row-->
        <div class="row">
            <!--Grid column-->
            <div class="col-md-8">
                <!-- pending -->
                <!--Card: Main question-->
                <div class="question-card payment_option card mb-4 maincard">
                    <!-- Card header -->
                    <div class="card-header pl-0 card_main forum-card-img-30 d-flex justify-content-between">
                        <p class="pt-2 mb-0 "> Payment Options  </p>                       
                    </div>
           
                  <input type="hidden" name="tid" id="tid" readonly />      
                  <input type="hidden" name="merchant_id" value="224525"/>
                  <input type="hidden" name="order_id" value="<?php echo $merchant_order_id ?>"/>
                  <input type="hidden" name="orderNo" value="<?php echo $merchant_order_id ?>"/>
                  <input type="hidden" name="amount" id="amount" value="<?php echo $total/100 ; ?>" />
                  <input type="hidden" name="currency" value="INR"/>
                  <input type="hidden" name="redirect_url" value="<?php echo base_url().'payment/success'?>"/>
                  <input type="hidden" name="cancel_url" value="<?php echo base_url().'payment/failed'?>"/>
                  <input type="hidden" name="language" value="EN"/>             
                  <input type="hidden" name="billing_name" value="<?php echo $order_dtail['user_name']; ?>"/>
                  <input type="hidden" name="billing_address" value="<?php echo $order_dtail['user_street_address']; ?>"/>
                   <input type="hidden" name="billing_city" value="<?php echo $order_dtail['user_city']; ?>"/>
                   <input type="hidden" name="billing_state" value="<?php echo $order_dtail['user_state']; ?>"/>
                   <input type="hidden" name="billing_zip" value="<?php echo $order_dtail['user_postcode']; ?>"/>
                   <input type="hidden" name="billing_country" value="<?php echo $order_dtail['country_name']; ?>"/>
                
                   <input type="hidden" name="billing_email" value="<?php echo $order_dtail['user_email_address']; ?>"/>

                    <input type="hidden" name="delivery_name" value="<?php echo $order_dtail['delivery_name']; ?>"/>
                    <input type="hidden" name="delivery_address" value="<?php echo $order_dtail['delivery_street_address']; ?>"/>
                    <input type="hidden" name="delivery_city" value="<?php echo $order_dtail['delivery_city']; ?>"/>
                    <input type="hidden" name="delivery_state" value="<?php echo $order_dtail['delivery_state']; ?>"/>
                    <input type="hidden" name="delivery_zip" value="<?php echo $order_dtail['delivery_postcode']; ?>"/>
                    <input type="hidden" name="delivery_country" value="<?php echo $order_dtail['country_name']; ?>"/>
                    <input type="hidden" name="delivery_tel" value="<?php echo $order_dtail['user_telephone']; ?>"/>
                    
                    <input type="hidden" name="total_qty" value="<?php echo $order_dtail['products_quantity'] ?>"/>
                    <input type="hidden" name="order_price" value="<?php echo $order_dtail['final_price'] ?>"/>
                    <input type="hidden" name="shipping_amt" value="<?php echo $order_dtail['shipping_cost'] ?>"/>
                    <input type="hidden" name="total_order_amount" id="total_order_amount" value="<?php echo $total/100 ; ?>"/>

                      <input type="hidden" id="card_type" name="card_type" value="" readonly="readonly"/>
                      <input type="hidden" name="payment_name" id="payment_name" />
                     
                      <input type="hidden" name="merchant_param1" id="wallet_option" value="unchecked"/>
                    <!--Card content-->
                    <div class="card-body">
                        <!--Accordion wrapper-->
                    <div class="accordion md-accordion accordion-blocks" id="accordionEx78" role="tablist" aria-multiselectable="true">

                      <!-- Accordion card -->
                       <!--credit card -->
                      <div class="card maincard1 cd1">
                        <!-- Card header -->
                        <div class="card-header" role="tab" id="headingUnfiled">
                          <div data-toggle="collapse" data-parent="#accordionEx78" href="#collapseUnfiled" aria-expanded="true"
                            aria-controls="collapseUnfiled">
                            <h5 class="mt-1 mb-0">
                            <span> <!-- Group of material radios - option 1 -->
                                  <div class="custom-control custom-radio">
                                     <!--<input type="radio" class="custom-control-input payOption radio_btn " id="defaultGroupExamplecredit" required name="payment_option" value="OPTCRDC">-->
                                       <input type="radio" class="custom-control-input payOption radio_btn" id="defaultGroupExamplecredit" name="payment_option" value="razorpay">
                                      <label class="custom-control-label" for="defaultGroupExamplecredit">Credit Card</label>
                                   </div>
                                
                            </span>                           
                            </h5>
                          </div>
                        </div>

                        <!-- Card body -->
                        
                        </div>
                     
                      <!-- Accordion card -->
                      <!--debit card -->

                       <div class="card maincard1">
                        <!-- Card header -->
                        <div class="card-header " role="tab" id="heading79">
                          <!--Options-->
                        <!-- Heading -->
                          <div data-toggle="collapse" data-parent="#accordionEx78" href="#collapse79" aria-expanded="true"
                            aria-controls="collapse79">
                            <h5 class="mt-1 mb-0">
                            <span> <!-- Group of material radios - option 1 -->
                                <!-- Default unchecked -->
                                <div class="custom-control custom-radio">
                                <!--<input type="radio" class="custom-control-input payOption radio_btn " id="defaultGroupExamplecredit1" name="payment_option" required value="OPTDBCRD">-->
                                <input type="radio" class="custom-control-input payOption radio_btn" id="defaultGroupExamplecredit1" name="payment_option" value="razorpay">
                                 <label class="custom-control-label" for="defaultGroupExamplecredit1">Debit Card</label>
                                </div>

                            </span>                           
                            </h5>
                          </div>

                        </div>

                        <!-- Card body -->
                        
                      </div>

                      <!-- Accordion card -->
                      <div class="card maincard1">
                        <!-- Card header -->
                        <div class="card-header" role="tab" id="heading80">
                          <!--Options-->
                      <!-- Heading -->
                          <div data-toggle="collapse" data-parent="#accordionEx78" href="#collapse85" aria-expanded="true"
                            aria-controls="collapse85">
                            <h5 class="mt-1 mb-0">
                            <span> <!-- Group of material radios - option 1 -->
                                <!-- Default unchecked -->
                                <div class="custom-control custom-radio">
                                      <!--<input type="radio" class="custom-control-input payOption radio_btn " id="defaultUnchecked2" name="payment_option" required value="OPTNBK">-->
                                      <input type="radio" class="custom-control-input payOption radio_btn" id="defaultUnchecked2" name="payment_option" value="razorpay">
                                      <label class="custom-control-label" for="defaultUnchecked2">Net Banking</label>
                                </div>
                        
                            </span>                           
                            </h5>
                          </div>
                        </div>

                        <!-- Card body -->
                        
                      </div>
                      <!-- Accordion card -->

                  <!-- Accordion card -->
                  <div class="card maincard1 display_none">
                    <!-- Card header -->
                    <div class="card-header" role="tab" id="heading">
                      <!--Options-->
                      <!-- Heading -->
                      <div data-toggle="collapse" data-parent="#accordionEx78" href="#collapse81" aria-expanded="true" aria-controls="collapse81">
                          <h5 class="mt-1 mb-0">
                            <span> <!-- Group of material radios - option 1 -->         
                                <div class="custom-control custom-radio">
                            <input type="radio" class="custom-control-input payOption radio_btn" id="defaultUnchecked3" name="payment_option" required value="OPTEMI">
                            <label class="custom-control-label" for="defaultUnchecked3">
                            EMI (Easy Installments)</label>
                            </div>                      
                            </span>                           
                            </h5>
                     
                    </div>
                    </div>

                    <!-- Card body -->
                    <div id="collapse81" class="collapse  cardP" role="tabpanel" aria-labelledby="heading"
                      data-parent="#accordionEx78" style="display:none;">
                      <div class="card-body">
                        <!--Top Table UI-->
                         <div class="bs-example px-4 py-5">
                        <!-- <h5>Pay in easy monthly installments from any of the options below.
                           <small>Terms and Conditions</small> 
                        </h5> -->
                        &nbsp;
                            <div class="accordion" id="accordionExample">
                                <div class="">

                                    <div class="" id="headingOne" style="display:none;">
                                        <h2 class="mb-0">
                                        <button type="button"  class=" btn-danger " data-toggle="collapse" data-target="#collapseOne">
                                        
                                        <i class="fa fa-plus"></i>&nbsp; No Cost EMI <small>Applicable on 2 products in your order</small></button>                                 
                                        </h2>
                                    </div>
                                    

                                   <div id="emi_div" style="display: none">
                                         <table border="1" width="100%">
                                         <tr> 
                                            <td colspan="2"><center>EMI Section</center> </td></tr>
                                         <tr> <td> Emi plan id: </td>
                                            <td><input readonly="readonly" type="text" id="emi_plan_id"  name="emi_plan_id" value=""/> </td>
                                         </tr>
                                         <tr>
                                          <td> Emi tenure id: </td>
                                            <td><input readonly="readonly" type="text" id="emi_tenure_id" name="emi_tenure_id" value=""/>  </td>
                                         </tr>
                                         <tr>
                                            <td>Pay Through</td>
                                             <td>
                                                 <select name="emi_banks"  id="emi_banks">
                                                 </select>
                                             </td>
                                        </tr>
                                        <tr>
                                            <td colspan="2">
                                             <div id="emi_duration" class="span12">
                                                <span class="span12 content-text emiDetails">
                                                    <center>EMI Duration</center></span>
                                                <table id="emi_tbl" border="1" width="100%">
                                                </table> 
                                            </div>
                                            </td>
                                        </tr>
                                        <tr>
                                             <td id="processing_fee" colspan="2">
                                            </td>
                                        </tr>
                                </table>
                             </div>

                                </div>
                            </div>
                        </div>
                      </div>
                    </div>
                  </div>
            
                  <!-- Accordion card -->
                   <div class="card maincard1 display_none" style="">
                    <!-- Card header -->
                    <div class="card-header" role="tab" id="heading00">
                      <!--Options-->
                      <!-- Heading -->
                      <div data-toggle="collapse" data-parent="#accordionEx78" href="#collapse70" aria-expanded="true"
                        aria-controls="collapse70">
                        <h5 class="mt-1 mb-0">
                        <span> <!-- Group of material radios - option 1 -->
                             <div class="custom-control custom-radio">
                                  <input type="radio" class="custom-control-input payOption checkboxClass radio_btn" id="defaultUnchecked6" name="payment_option" required value="OPTWLT">
                                  <label class="custom-control-label" for="defaultUnchecked6"> Wallet </label>
                             </div>                     
                        </span>                           
                        </h5>
                      </div>
                    </div>
                    <!-- Card body -->
                    
                  </div>
                  
                  
                  <!-- Accordion card -->
                   <div class="card maincard1 display_none" style="">
                    <!-- Card header -->
                    <div class="card-header" role="tab" id="heading">
                      <!--Options-->
                      <!-- Heading -->
                      <div data-toggle="collapse" data-parent="#accordionEx79" href="#collapse82" aria-expanded="true"
                        aria-controls="collapse82">
                          <h5 class="mt-1 mb-0">
                            <span> <!-- Group of material radios - option 1 -->
                                <!-- Default unchecked -->
                            <div class="custom-control custom-radio">
                                  <input type="radio" class="custom-control-input payOption radio_btn" id="defaultUnchecked5" name="payment_option" value="razorpay">
                                  <label class="custom-control-label" for="defaultUnchecked5"> RazorPay </label>
                             </div> 
                        
                            </span>                           
                            </h5>
                      </div>
                    </div>

                    <!-- Card body -->
                    <div id="collapse82" class="collapse " role="tabpanel" aria-labelledby="heading"
                      data-parent="#accordionEx79">
                      <div class="card-body">
                        <!--Top Table UI-->
                            <div class="m-4">

                                   <h5 class="mt-1 mb-0">
                               <!-- Group of material radios - option 1 -->
                                <!-- Default unchecked -->
                            <div class="custom-control custom-radio">
                                  <input type="radio" class="custom-control-input payOption" id="defaultUnchecked" name="payment_option2" onclick="razorpaySubmit(this);">
                                  <label class="custom-control-label" for="defaultUnchecked"> Razorpay </label>
                             </div> 
                        
                                                  
                            </h5>

                            </div>
                      </div>
                    </div>
                  </div>
         
       </div>
       </div>
                    <!--end content--->    
        </form>


                  <!---razor payment gateway--->

                   <?php 

                   if ($pending_order == 'Accepted') { ?>
                <form name="razorpay-form" id="razorpay-form" action="<?php echo $return_url; ?>" method="POST">
                    <input type="hidden" name="razorpay_payment_id" id="razorpay_payment_id" />
                    <input type="hidden" name="merchant_order_id" id="merchant_order_id" value="<?php echo $merchant_order_id; ?>"/>
                    <input type="hidden" name="merchant_trans_id" id="merchant_trans_id" value="<?php echo $txnid; ?>"/>
                    <input type="hidden" name="merchant_product_info_id" id="merchant_product_info_id" value="<?php echo $productinfo; ?>"/>
                    <input type="hidden" name="merchant_surl_id" id="merchant_surl_id" value="<?php echo $surl; ?>"/>
                    <input type="hidden" name="merchant_furl_id" id="merchant_furl_id" value="<?php echo $furl; ?>"/>
                    <input type="hidden" name="card_holder_name_id" id="card_holder_name_id" value="<?php echo $card_holder_name; ?>"/>
                    <input type="hidden" name="merchant_total" id="merchant_total" value="<?php echo $total ?>"/>

                    <input type="hidden" name="order_id" id="order_id" value="<?php echo $merchant_order_id; ?>"/>
                    <input type="hidden" name="wallet_option1" id="wallet_option1" value="unchecked"/>
                </form>

            <?php } ?>


                </div>
                <!--/.Accordion wrapper-->
                <!-- Comments -->
                </div>

            <!--Grid column-->
            <div class="col-md-4">
                <!--Card-->
                <div class="card maincard payment_option ">
                    <!-- Card header -->
                    <div class="card-header card_main">  <p class="pt-2 mb-0"> Amount  </p>    </div>
                    <!--Card content-->
                    <div class="card-body">
                        <table class="table tablew ">   
                        <tbody>
                            <tr>                         
								<th><strong>Order Amount:</strong></th>
								<td>&#x20b9;<?php echo number_format($totalBalance, 2); ?></td>
                            </tr>
							<tr> 
							 <th><strong>Shipping Amount:</strong></th>
							  <td><?php 
                            if($totalBalance >=500 && $shippment_type=='Free')
                            {
                                echo '<span style="color:green;">Free</span>';
                            }else{
                            echo number_format($shipping_cost, 2); } ?></td>
							
							</tr>
							
							<tr>
								 <th><strong>Total Amount:</strong></th>							
								 <td class="">&#x20b9;<span class="order_amount"><?php echo number_format($order_price, 2); ?></span></td>
							 </tr>
                          
                        </tbody>
                      </table>

                    </div>
                </div>
                <!--/.Card-->
			</div>
			
	   <div class="col md-2" id="PayButtonDiv" style="">
        <label for="x_card_code" class="control-label mb-1"></label>
        <button id="payment-button" type="submit" class="btn btn-lg btn-danger btn-block submit" >        
            Pay <strong>&#x20b9;</strong> <span class="order_amount" id="payment-button-amount" ><?php echo number_format($order_dtail['order_price'], 2); ?></span>
            <!-- <span id="payment-button-sending" style="display:none;">Sending…</span> -->
        </button>        
       </div>  
	   
		</div>	
		
			 <!--Grid column-->
            <div class="row mt-5">
                <!--Card-->
				 <!--Grid column-->
               <div class="col-md-6 mb-4 ">
                <div class="card mb-4 maincard mmnew">
                    <!-- Card header -->
                    <div class="card-header"><b>Billing Information</b></div>
                    <!--Card content-->
                    <div class="card-body d-flex justify-content-between">

                        <ul class="list-unstyled">
                            <li>
                                <strong>Billing Name:</strong>
                                <span><?php echo $order_dtail['delivery_name']; ?></span>
                                
                            </li>
                            <li>
                                <strong>Billing Address:</strong>
                                <span><?php echo $order_dtail['delivery_street_address']; ?></span>
                                
                            </li>
                            <li>
                                <strong>Billing City:</strong>
                                <span><?php echo $order_dtail['delivery_city'];?></span>
                               
                            </li>
                            <li>
                                <strong>Billing State:</strong>
                                <span><?php echo $order_dtail['delivery_state'];?></span>
                                
                            </li>
                            <li>
                                <strong>Billing Zip:</strong>
                                <span><?php echo $order_dtail['delivery_postcode'] ;?></span>
                                
                            </li>
                            <li>
                                <strong>Country:</strong>
                                <span><?php echo $order_dtail['country_name']?></span>
                              
                            </li>
                           
                        </ul>
                    </div>
                </div>
            </div>
				
				
 <!--Grid column-->
            <div class="col-md-6 mb-4 ">
                <div class="card mb-4 maincard mmnew">
                    <!-- Card header -->
                    <div class="card-header"><b>Shipping Information</b></div>
                    <!--Card content-->
                    <div class="card-body">
                        <ul class="list-unstyled">
                            <li>
                                <strong>Shipping Name:</strong>
                                <span><?php echo $order_dtail['delivery_name']; ?></span>
                               
                            </li>
                            <li>
                                <strong>Shipping Address:</strong>
                                <span><?php echo $order_dtail['delivery_street_address']; ?></span>
                               
                            </li>
                            <li>
                                <strong>Shipping City:</strong>
                                <span><?php echo $order_dtail['delivery_city'];?></span>
                           
                            </li>
                             <li>
                                <strong>Shipping ZipCode:</strong>
                                <span><?php echo $order_dtail['delivery_postcode'] ;?></span>
                              
                            </li>
                            <li>
                                <strong>Shipping State:</strong>
                                <span><?php echo $order_dtail['delivery_state'];?></span>
                               
                            </li>
                            <li>
                                <strong>Shipping Country:</strong>
                                <span><?php echo $order_dtail['country_name']?></span>
                        
                            </li>
                            <li>
                                <strong>Estimated Shipping Date:</strong>
                                <span><?php echo date('d M Y', strtotime($order_dtail['shipping_expected_date'])); ?></span>
                        
                            </li>
                           
                        </ul>
                    </div>
                </div>

                <!--/.Card-->
 
            </div>
            <!--Grid column-->
           
        </div>
        <!--Grid row-->
    </div><!--container row-->
</main>
</div>
</div>



    <!--payment div -->
    <script src="<?php echo base_url('assets/front/js/jquery-3.2.1.min.js')?>"></script>
    <script src="https://code.jquery.com/jquery-1.11.3.min.js"></script>
    <script src="https://checkout.razorpay.com/v1/checkout.js"></script>
   
        <script>
//            $(document).ready(function() {
//                $('#payment-button').click(function(event){
//                    event.preventDefault(); //do before actual submitting the form
//                    /**
//                     * Here we check whether the offer has expired for selected cart
//                     * products
//                     * if yes then empty cart products and redirect to cart with
//                     * proper message
//                     * */
//                        $.post( "<?php echo base_url('userorder/checkOfferBeforePay') ?>", { order_id: "<?php echo $order_dtail['orders_id'] ?>" })
//                            .done(function( offerExpired ) {
//                                if(offerExpired > 0) {
//                                    $('#paymentForm').attr( "action", "<?php echo base_url('home_product/getCartProducts'); ?>" );
//                                    window.location.href = "<?php echo base_url('home_product/getCartProducts'); ?>";
//                                    exit();
//                                }
//                            });
//                    event.preventDefault(); //do before actual submitting the form
//                });
//            });
//            }
        </script>

    <script>
                             
                                   
                                    var razorpay_submit_btn, razorpay_instance;

                                    function razorpaySubmit(el) {
                                        /**
                                         * Before calling razor pay we check 
                                         * whether the user has been banned by admin or not
                                         * iff yes(true) then don't let them shopping
                                         * logout of the system by redirecting
                                         * @param pass nothing we will check it from session
                                         */
                                        $(document).ready(function () {
                                            $.post('<?php echo base_url('userorder/checkBeforePay') ?>')
                                                    .done(function (isBanned) {
                                                        if(isBanned == 0){
                                                            alert('Your account has been banned. Please contact support!');
                                                            window.location.href = "<?php echo base_url('login'); ?>";
                                                            exit();
                                                        } 
                                                        
                                                    });
                                        });

                                        /**
                                         * Here we check whether the offer has expired for selected cart
                                         * products
                                         * if yes then empty cart products and redirect to cart with
                                         * proper message
                                         * */
                                        $(document).ready(function () {
                                            $.post( "<?php echo base_url('userorder/checkOfferBeforePay') ?>", { order_id: "<?php echo $order_dtail['orders_id'] ?>" })
                                                .done(function( offerExpired ) {
                                                    if(offerExpired > 0){
                                                        window.location.href = "<?php echo base_url('home_product/getCartProducts'); ?>";
                                                        exit();
                                                    }
                                                });
                                        });


                            var razorpay_options = {
                                    key: "<?php echo $key_id; ?>",
                                    amount: $('#merchant_total').val(),
                                    name: "<?php echo $name; ?>",
                                    description: "Order # <?php echo $merchant_order_id; ?>",
                                    netbanking: true,
                                    currency: "<?php echo $currency_code; ?>",
                                    //order_id: "<?php echo $merchant_order_id; ?>",
                                    prefill: {
                                        name: "<?php echo $card_holder_name; ?>",
                                        email: "<?php echo $email; ?>",
                                        contact: "<?php echo $phone; ?>",
                                    },
                                    notes: {
                                        soolegal_order_id: "<?php echo $merchant_order_id; ?>",
                                    },
                                    handler: function (transaction) {

                                        document.getElementById('razorpay_payment_id').value = transaction.razorpay_payment_id;
                                        document.getElementById('razorpay-form').submit();
                                        $('#loading').show();
                                    },
                                    "modal": {
                                        "ondismiss": function () {
                                            location.reload()
                                        }
                                    }
                                };


                                        if (typeof Razorpay == 'undefined') {
                                            setTimeout(razorpaySubmit, 200);
                                            if (!razorpay_submit_btn && el) {
                                                razorpay_submit_btn = el;
                                                el.disabled = true;
                                                el.value = 'Please wait...';
                                            }
                                        } else {

                                            if (!razorpay_instance) {
                                                
                                                razorpay_instance = new Razorpay(razorpay_options);
                                                if (razorpay_submit_btn) {
                                                    razorpay_submit_btn.disabled = false;
                                                    razorpay_submit_btn.value = "Pay Now";
                                                }
                                            }
                                            razorpay_instance.open();
                                        }
                                    }


$("input[type=radio]").on("click",function(e){


    if($(this).val()==='razorpay')
    {
        // $('#PayButtonDiv').toggle();
         razorpaySubmit(this);
    }
    else
    {
        // $('#PayButtonDiv').show();   
    }
});


$(".payOption").click(function(){
  var paymentOption = $(this).val();
   // alert(paymentOption.replace("OPT",""));
    $("#card_type").val(paymentOption.replace("OPT",""));
       
});


 $(document).ready(function(e){

 // $('input[type=radio]:checked').prop('checked', false).checkboxradio("refresh");
 $(".checkboxClass").val('unchecked');
 $(".checkboxClass").prop("checked", false);
 $(".checkboxClass").val('');

  

window.onload = function() {
        var d = new Date().getTime();
        document.getElementById("tid").value = d;
        
    };


    $("input[type=radio]").on("click", function (e) {
      
             $(this).val(this.checked ? "checked" : "unchecked");
              // $(".radio_btn").attr('required', false);
    });
   
   
    

   

var wallet_bal='<?php echo $bal->balance??0;?>'; 
 
var total_amt=<?php echo $order_price ?>;
var total_amt1=<?php echo $total/100 ?>;

  /*
        @author Ishwar
        This Function Check radio button validation before Payment
       */
    
     $(".submit").on("click",function(e){
         
         if ($('input[name="payment_option"]:checked').length == 0)
        {
           alert("Please select at Least one Payment Options to make Payment !");
           // location.reload();
            return false;
        }
            
       if(wallet_bal>total_amt)
          {
                if($(".checkboxClass").prop("checked", true))
                {
                        $(".radio_btn").prop('disabled',false);  
                        $(".radio_btn").prop("checked", true);
                        $('#loading').show();

                      var formAction = '<?php echo base_url(); ?>m/home/payment_process';
                      //set form action
                      $('#customerData').attr('action', formAction);
                      //submit form
                      $('#customerData').submit();
                      $('#loading').show();  
                }
               else
               {
                     // do something
                    razorpaySubmit(this); 
                    return true;
               }

            
          }
          else
          {
               // do something
                razorpaySubmit(this); 
                return true;
            
         }
        
    

    });
    
if(wallet_bal>0) 
{
    $('.walletDiv').show();
}
else if(!wallet_bal || wallet_bal=='' || wallet_bal==0)
{
    $('.walletDiv').hide();
}

$('#wallet_balance').html("<i class='fa fa-inr' aria-hidden='true'></i> " +parseFloat(wallet_bal).toFixed(2));
$('#total_order_price').html(total_amt.toFixed(2));


 $(document).on("click",".checkboxClass",function(e){
          
         var wallet_bal='<?php echo $bal->balance??0; ?>'; 
         var total_amt=<?php echo $order_price; ?>;
         $('#chk_wallet_val').val(this.checked ? "checked" : "unchecked");
         $('#wallet_option1').val(this.checked ? "checked" : "unchecked");
         $('#wallet_option').val(this.checked ? "checked" : "unchecked");

         $(this).val(this.checked ? "checked" : "unchecked");
         var chk_value = jQuery(".checkboxClass:checked").length;
          
        if(chk_value>0)
        {

             if(!wallet_bal || wallet_bal == 0 && wallet_bal=='')
            {
               $('#p_error').html(''); 
              
               $('#p_error').html('You Do Not Have Sufficient Amount in Your Wallet !');
                $('#p_error').fadeIn("slow");
                $('#p_error').fadeOut(3000);
                return false;
            }
             else if(wallet_bal > 0 && total_amt >0)
            {
                // aval_bal>=total_amt || aval_bal<=total_amt 
                var finalAmount=0;

                if(total_amt>wallet_bal)
                {
                        
                         finalAmount=parseFloat(total_amt)-parseFloat(wallet_bal);

                          $('#wallet_balance').html("<i class='fa fa-inr' aria-hidden='true'></i> " +'0.00');   
                          $('#wallet_amount').val('0.00');
                          $('.order_amount').html(finalAmount.toFixed(2));   
                          $('#total_amount').val(finalAmount.toFixed(2)); 
                          $('input[name="merchant_total"]:hidden').attr('value',Math.round(finalAmount*100));
                          $("#amount").val(finalAmount.toFixed(2));
                          $(".radio_btn").prop('disabled',false);  
                          $(".radio_btn").prop("checked", false);
                          // $('.radio_btn').attr('required', true);
                          
                }
                else if(wallet_bal>total_amt)               
                 {
                    
                      finalAmount=parseFloat(wallet_bal)-parseFloat(total_amt);  
                  
                      $('#wallet_balance').html("<i class='fa fa-inr' aria-hidden='true'></i> " +finalAmount.toFixed(2));
                      $('#wallet_amount').val(finalAmount.toFixed(2));
                      $('.order_amount').html(total_amt.toFixed(2)); 
                      $('#total_amount').val(total_amt.toFixed(2)); 
                      $('input[name="merchant_total"]:hidden').val(Math.round(total_amt*100));
                      $("#amount").val(total_amt1.toFixed(2));
                      $(".radio_btn").prop('disabled', true);  
                      $(".radio_btn").prop("checked", true);
                 } 
                 else if(total_amt==wallet_bal)
                 {
                        $(".radio_btn").prop('disabled', true);  
                        $('.radio_btn').attr('required', false);
                        $(".radio_btn").prop("checked", false);
                        $('#wallet_balance').html("<i class='fa fa-inr' aria-hidden='true'></i> " +'0.00');
                        $('.order_amount').html(total_amt.toFixed(2));
                 }  
            }

        }
        else
        {
             $('#wallet_balance').html("<i class='fa fa-inr' aria-hidden='true'></i> " +parseFloat(wallet_bal).toFixed(2));
             $('#wallet_amount').val(parseFloat(wallet_bal).toFixed(2));
             $('.order_amount').html(total_amt.toFixed(2));
             $('#total_amount').val(total_amt.toFixed(2)); 
             $('input[name="merchant_total"]:hidden').val(<?php echo $total ?>);
             $("#amount").val(total_amt1.toFixed(2));
             $(".radio_btn").prop('disabled', false);
             // $(".radio_btn").prop("checked", false);
            $('.radio_btn').attr('required', true);
        }   

        });
    });

    </script>